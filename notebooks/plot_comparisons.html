
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Plot Comparisons &#8212; Bambi 0.13.0.dev documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=e937bb23"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/plot_comparisons';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="API Reference" href="../api_reference.html" />
    <link rel="prev" title="Plot Conditional Adjusted Predictions" href="plot_cap.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs..."
         aria-label="Search the docs..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/Bambi_logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/Bambi_logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="getting_started.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../examples.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api_reference.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../faq.html">
                        Frequently Asked Questions
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/bambinos/bambi" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/bambi/" title="PyPi" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fas fa-box"></i></span>
            <label class="sr-only">PyPi</label></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="getting_started.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../examples.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api_reference.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../faq.html">
                        Frequently Asked Questions
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/bambinos/bambi" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/bambi/" title="PyPi" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fas fa-box"></i></span>
            <label class="sr-only">PyPi</label></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<div id="searchbox"></div></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../examples.html" class="nav-link">Examples</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Plot Comparisons</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="Plot-Comparisons">
<h1>Plot Comparisons<a class="headerlink" href="#Plot-Comparisons" title="Permalink to this heading">#</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">comparisons</span></code> and <code class="docutils literal notranslate"><span class="pre">plot_comparisons</span></code> are a part of Bambi’s sub-package <code class="docutils literal notranslate"><span class="pre">plots</span></code> that feature a set of functions used to interpret complex regression models. This sub-package is inspired by the R package <a class="reference external" href="https://vincentarelbundock.github.io/marginaleffects/articles/predictions.html#conditional-adjusted-predictions-plot">marginaleffects</a>. These two functions allow the modeler to <strong>compare</strong> the predictions made by a model for different contrast and covariate values. Below, it is described
why comparing predictions is useful in interpreting generalized linear models (GLMs), how this methodology is implemented in Bambi, and how to use <code class="docutils literal notranslate"><span class="pre">comparisons</span></code> and <code class="docutils literal notranslate"><span class="pre">plot_comparisons</span></code>. It is assumed that the reader is familiar with the basics of GLMs. If not, refer to the Bambi <a class="reference external" href="https://bambinos.github.io/bambi/notebooks/how_bambi_works.html#Link-functions">Basic Building Blocks</a> example.</p>
<p>Due to the link function in a GLM, there are typically three quantities of interest to interpret:</p>
<ol class="arabic simple">
<li><p>the linear predictor <span class="math notranslate nohighlight">\(\eta = X\beta\)</span> where <span class="math notranslate nohighlight">\(X\)</span> is an <span class="math notranslate nohighlight">\(n\)</span> x <span class="math notranslate nohighlight">\(p\)</span> matrix of explanatory variables.</p></li>
<li><p>the mean <span class="math notranslate nohighlight">\(\mu = g^{-1}(\eta)\)</span> where the link function <span class="math notranslate nohighlight">\(g(\cdot)\)</span> relates the linear predictor to the mean of the outcome variable <span class="math notranslate nohighlight">\(\mu = g^{-1}(\eta) = g^{-1}(X\beta)\)</span></p></li>
<li><p>the response variable <span class="math notranslate nohighlight">\(Y \sim \mathcal{D}(\mu, \theta)\)</span> where <span class="math notranslate nohighlight">\(\mu\)</span> is the mean parameter and <span class="math notranslate nohighlight">\(\theta\)</span> is (possibly) a vector that contains all the other “auxillary” parameters of the distribution.</p></li>
</ol>
<p>Often, with GLMs, <span class="math notranslate nohighlight">\(\eta\)</span> is linear in the parameters, but nonlinear in relation of inputs to the outcome <span class="math notranslate nohighlight">\(Y\)</span> due to the link function <span class="math notranslate nohighlight">\(g\)</span>. Thus, as modelers, we are usually more interested in interpreting (2) and (3). For example, in logistic regression, the linear predictor is on the log-odds scale, but the quantity of interest is on the probability scale. In Poisson regression, the linear predictor is on the log-scale, but the response variable is on the count scale.
Referring back to logistic regression, a specified difference in one of the <span class="math notranslate nohighlight">\(x\)</span> variables does <em>not</em> correspond to a constant difference in the the probability of the outcome.</p>
<p>It is often helpful with GLMs, for the modeler and audience, to have a summary that gives the expected difference in the outcome corresponding to a unit difference in each of the input variables. Thus, the goal of <code class="docutils literal notranslate"><span class="pre">comparisons</span></code> and <code class="docutils literal notranslate"><span class="pre">plot_comparisons</span></code> is to provide the modeler with a summary and visualization of the average predicted difference.</p>
<section id="Average-Predictive-Differences">
<h2>Average Predictive Differences<a class="headerlink" href="#Average-Predictive-Differences" title="Permalink to this heading">#</a></h2>
<p>Here, we adopt the notation from Chapter 14.4 of <a class="reference external" href="https://avehtari.github.io/ROS-Examples/">Regression and Other Stories</a> to describe average predictive differences. Assume we have fit a Bambi model predicting an outcome <span class="math notranslate nohighlight">\(Y\)</span> based on inputs <span class="math notranslate nohighlight">\(X\)</span> and parameters <span class="math notranslate nohighlight">\(\theta\)</span>. Consider the following scalar inputs:</p>
<div class="math notranslate nohighlight">
\[u: \text{the input of interest}\]</div>
<div class="math notranslate nohighlight">
\[v: \text{all the other inputs}\]</div>
<div class="math notranslate nohighlight">
\[X = (u, v)\]</div>
<p>Suppose for the input of interest, we are interested in comparing <span class="math notranslate nohighlight">\(u^{\text{high}}\)</span> to <span class="math notranslate nohighlight">\(u^{\text{low}}\)</span> (perhaps age = <span class="math notranslate nohighlight">\(60\)</span> and <span class="math notranslate nohighlight">\(40\)</span> respectively) with all other inputs <span class="math notranslate nohighlight">\(v\)</span> held constant. The <em>predictive difference</em> in the outcome changing <strong>only</strong> <span class="math notranslate nohighlight">\(u\)</span> is:</p>
<div class="math notranslate nohighlight">
\[\text{average predictive difference} = \mathbb{E}(y|u^{\text{high}}, v, \theta) - \mathbb{E}(y|u^{\text{low}}, v, \theta)\]</div>
<p>Selecting the maximum and minimum values of <span class="math notranslate nohighlight">\(u\)</span> and averaging over all other inputs <span class="math notranslate nohighlight">\(v\)</span> in the data gives you a new “hypothetical” dataset and corresponds to counting all pairs of transitions of <span class="math notranslate nohighlight">\((u^\text{low})\)</span> to <span class="math notranslate nohighlight">\((u^\text{high})\)</span>, i.e., differences in <span class="math notranslate nohighlight">\(u\)</span> with <span class="math notranslate nohighlight">\(v\)</span> held constant. The difference between these two terms is the average predictive difference.</p>
<section id="Computing-Average-Predictive-Differences">
<h3>Computing Average Predictive Differences<a class="headerlink" href="#Computing-Average-Predictive-Differences" title="Permalink to this heading">#</a></h3>
<p>The objective of <code class="docutils literal notranslate"><span class="pre">comparisons</span></code> and <code class="docutils literal notranslate"><span class="pre">plot_comparisons</span></code> is to compute the expected difference in the outcome corresponding to three different scenarios for <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span> where <span class="math notranslate nohighlight">\(u\)</span> is either provided by the user, else a default value is computed by Bambi (described in the default values section). The three scenarios are:</p>
<ol class="arabic simple">
<li><p>user provided values for <span class="math notranslate nohighlight">\(v\)</span>.</p></li>
<li><p>a grid of equally spaced and central values for <span class="math notranslate nohighlight">\(v\)</span>.</p></li>
<li><p>empirical distribution (original data used to fit the model) for <span class="math notranslate nohighlight">\(v\)</span>.</p></li>
</ol>
<p>In the case of (1) and (2) above, Bambi assembles all pairwise combinations (transitions) of <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span> into a new “hypothetical” dataset. In (3), Bambi uses the original <span class="math notranslate nohighlight">\(v\)</span>, but replaces <span class="math notranslate nohighlight">\(u\)</span> with the user provided value or the default value computed by Bambi. In each scenario, predictions are made on the data using the fitted model. Once the predictions are made, comparisons are computed using the posterior samples by taking the difference in the predicted outcome for
each pair of transitions. The average of these differences is the average predictive difference.</p>
<p>Thus, the goal of <code class="docutils literal notranslate"><span class="pre">comparisons</span></code> and <code class="docutils literal notranslate"><span class="pre">plot_comparisons</span></code> is to provide the modeler with a summary and visualization of the average predictive difference. Below, we demonstrate how to compute and plot average predictive differences with <code class="docutils literal notranslate"><span class="pre">comparisons</span></code> and <code class="docutils literal notranslate"><span class="pre">plot_comparions</span></code> using several examples.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">arviz</span> <span class="k">as</span> <span class="nn">az</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>


<span class="kn">import</span> <span class="nn">bambi</span> <span class="k">as</span> <span class="nn">bmb</span>
<span class="kn">from</span> <span class="nn">bambi.plots</span> <span class="kn">import</span> <span class="n">comparisons</span><span class="p">,</span> <span class="n">plot_comparison</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Zero-Inflated-Poisson">
<h2>Zero Inflated Poisson<a class="headerlink" href="#Zero-Inflated-Poisson" title="Permalink to this heading">#</a></h2>
<p>We model and predict how many fish are caught by visitors at a state park using survey <a class="reference external" href="%22https://stats.idre.ucla.edu/stat/data/fish.csv%22">data</a>. Many visitors catch zero fish, either because they did not fish at all, or because they were unlucky. We would like to explicitly model this bimodal behavior (zero versus non-zero) using a Zero Inflated Poisson model, and to compare how different inputs of interest <span class="math notranslate nohighlight">\(u\)</span> and other covariate values <span class="math notranslate nohighlight">\(v\)</span> are associated with the number of
fish caught. The dataset contains data on 250 groups that went to a state park to fish. Each group was questioned about how many fish they caught (<code class="docutils literal notranslate"><span class="pre">count</span></code>), how many children were in the group (<code class="docutils literal notranslate"><span class="pre">child</span></code>), how many people were in the group (<code class="docutils literal notranslate"><span class="pre">persons</span></code>), if they used a live bait and whether or not they brought a camper to the park (<code class="docutils literal notranslate"><span class="pre">camper</span></code>).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fish_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="s2">&quot;http://www.stata-press.com/data/r11/fish.dta&quot;</span><span class="p">)</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="s2">&quot;livebait&quot;</span><span class="p">,</span> <span class="s2">&quot;camper&quot;</span><span class="p">,</span> <span class="s2">&quot;persons&quot;</span><span class="p">,</span> <span class="s2">&quot;child&quot;</span><span class="p">]</span>
<span class="n">fish_data</span> <span class="o">=</span> <span class="n">fish_data</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span>
<span class="n">fish_data</span><span class="p">[</span><span class="s2">&quot;livebait&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">fish_data</span><span class="p">[</span><span class="s2">&quot;livebait&quot;</span><span class="p">])</span>
<span class="n">fish_data</span><span class="p">[</span><span class="s2">&quot;camper&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">fish_data</span><span class="p">[</span><span class="s2">&quot;camper&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fish_model</span> <span class="o">=</span> <span class="n">bmb</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span>
    <span class="s2">&quot;count ~ livebait + camper + persons + child&quot;</span><span class="p">,</span>
    <span class="n">fish_data</span><span class="p">,</span>
    <span class="n">family</span><span class="o">=</span><span class="s1">&#39;zero_inflated_poisson&#39;</span>
<span class="p">)</span>

<span class="n">fish_idata</span> <span class="o">=</span> <span class="n">fish_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">draws</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">target_accept</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">,</span>
    <span class="n">chains</span><span class="o">=</span><span class="mi">4</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [count_psi, Intercept, livebait, camper, persons, child]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
  <progress value='8000' class='' max='8000' style='width:300px; height:20px; vertical-align: middle;'></progress>
  100.00% [8000/8000 00:03&lt;00:00 Sampling 4 chains, 0 divergences]
</div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 4 seconds.
</pre></div></div>
</div>
<section id="User-Provided-Values">
<h3>User Provided Values<a class="headerlink" href="#User-Provided-Values" title="Permalink to this heading">#</a></h3>
<p>First, an example of scenario 1 (user provided values) is given below. In both <code class="docutils literal notranslate"><span class="pre">plot_comparisons</span></code> and <code class="docutils literal notranslate"><span class="pre">comparisons</span></code>, <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span> are represented by <code class="docutils literal notranslate"><span class="pre">contrast</span></code> and <code class="docutils literal notranslate"><span class="pre">conditional</span></code>, respectively. The modeler has the ability to pass their own values for <code class="docutils literal notranslate"><span class="pre">contrast</span></code> and <code class="docutils literal notranslate"><span class="pre">conditional</span></code> by using a dictionary where the key-value pairs are the covariate and value(s) of interest. For example, if we wanted to compare the number of fish caught for <span class="math notranslate nohighlight">\(4\)</span> versus <span class="math notranslate nohighlight">\(1\)</span> <code class="docutils literal notranslate"><span class="pre">persons</span></code>
conditional on a range of <code class="docutils literal notranslate"><span class="pre">child</span></code> and <code class="docutils literal notranslate"><span class="pre">livebait</span></code> values, we would pass the following dictionary in the code block below. By default, for <span class="math notranslate nohighlight">\(u\)</span>, Bambi compares <span class="math notranslate nohighlight">\(u^\text{high}\)</span> to <span class="math notranslate nohighlight">\(u^\text{low}\)</span>. Thus, in this example, <span class="math notranslate nohighlight">\(u^\text{high}\)</span> = 4 and <span class="math notranslate nohighlight">\(u^\text{low}\)</span> = 1. The user is not limited to passing a list for the values. A <code class="docutils literal notranslate"><span class="pre">np.array</span></code> can also be used. Furthermore, Bambi by default, maps the order of the dict keys to the main, group, and panel of the matplotlib
figure. Below, since <code class="docutils literal notranslate"><span class="pre">child</span></code> is the first key, this is used for the x-axis, and <code class="docutils literal notranslate"><span class="pre">livebait</span></code> is used for the group (color). If a third key was passed, it would be used for the panel (facet).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_comparison</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">fish_model</span><span class="p">,</span>
    <span class="n">idata</span><span class="o">=</span><span class="n">fish_idata</span><span class="p">,</span>
    <span class="n">contrast</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;persons&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
    <span class="n">conditional</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;child&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;livebait&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]},</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_plot_comparisons_9_0.png" src="../_images/notebooks_plot_comparisons_9_0.png" />
</div>
</div>
<p>The plot above shows that, comparing <span class="math notranslate nohighlight">\(4\)</span> to <span class="math notranslate nohighlight">\(1\)</span> persons given <span class="math notranslate nohighlight">\(0\)</span> children and using livebait, the expected difference is about <span class="math notranslate nohighlight">\(26\)</span> fish. When not using livebait, the expected difference decreases substantially to about <span class="math notranslate nohighlight">\(5\)</span> fish. Using livebait with a group of people is associated with a much larger expected difference in the number of fish caught.</p>
<p><code class="docutils literal notranslate"><span class="pre">comparisons</span></code> can be called to view a summary dataframe that includes the term <span class="math notranslate nohighlight">\(u\)</span> and its contrast, the specified <code class="docutils literal notranslate"><span class="pre">conditional</span></code> covariate, and the expected difference in the outcome with the uncertainty interval (by default the 94% highest density interval is computed).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comparisons</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">fish_model</span><span class="p">,</span>
    <span class="n">idata</span><span class="o">=</span><span class="n">fish_idata</span><span class="p">,</span>
    <span class="n">contrast</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;persons&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
    <span class="n">conditional</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;child&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;livebait&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]},</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>term</th>
      <th>contrast</th>
      <th>child</th>
      <th>livebait</th>
      <th>camper</th>
      <th>estimate</th>
      <th>lower_3.0%</th>
      <th>upper_97.0%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>persons</td>
      <td>(1, 4)</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.834472</td>
      <td>2.563472</td>
      <td>7.037150</td>
    </tr>
    <tr>
      <th>1</th>
      <td>persons</td>
      <td>(1, 4)</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>26.423188</td>
      <td>23.739729</td>
      <td>29.072748</td>
    </tr>
    <tr>
      <th>2</th>
      <td>persons</td>
      <td>(1, 4)</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.202003</td>
      <td>0.631629</td>
      <td>1.780965</td>
    </tr>
    <tr>
      <th>3</th>
      <td>persons</td>
      <td>(1, 4)</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>6.571943</td>
      <td>5.469275</td>
      <td>7.642248</td>
    </tr>
    <tr>
      <th>4</th>
      <td>persons</td>
      <td>(1, 4)</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.301384</td>
      <td>0.143676</td>
      <td>0.467608</td>
    </tr>
    <tr>
      <th>5</th>
      <td>persons</td>
      <td>(1, 4)</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.648417</td>
      <td>1.140415</td>
      <td>2.187190</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>But why is <code class="docutils literal notranslate"><span class="pre">camper</span></code> also in the summary dataframe? This is because in order to peform predictions, Bambi is expecting a value for each covariate used to fit the model. Additionally, with GLM models, average predictive comparisons are conditional in the sense that the estimate depends on the values of all the covariates in the model. Thus, for unspecified covariates, <code class="docutils literal notranslate"><span class="pre">comparisons</span></code> and <code class="docutils literal notranslate"><span class="pre">plot_comparisons</span></code> computes a default value (mean or mode based on the data type of the covariate). Thus,
<span class="math notranslate nohighlight">\(v\)</span> = <code class="docutils literal notranslate"><span class="pre">child</span></code>, <code class="docutils literal notranslate"><span class="pre">livebait</span></code>, <code class="docutils literal notranslate"><span class="pre">camper</span></code>. Each row in the summary dataframe is read as “comparing <span class="math notranslate nohighlight">\(4\)</span> to <span class="math notranslate nohighlight">\(1\)</span> persons conditional on <span class="math notranslate nohighlight">\(v\)</span>, the expected difference in the outcome is <span class="math notranslate nohighlight">\(y\)</span>.”</p>
</section>
<section id="Multiple-contrast-values">
<h3>Multiple contrast values<a class="headerlink" href="#Multiple-contrast-values" title="Permalink to this heading">#</a></h3>
<p>Users can also perform comparisons on multiple contrast values. For example, if we wanted to compare the number of fish caught between <span class="math notranslate nohighlight">\((1, 2)\)</span>, <span class="math notranslate nohighlight">\((1, 4)\)</span>, and <span class="math notranslate nohighlight">\((2, 4)\)</span> <code class="docutils literal notranslate"><span class="pre">persons</span></code> conditional on a range of values for <code class="docutils literal notranslate"><span class="pre">child</span></code> and <code class="docutils literal notranslate"><span class="pre">livebait</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">multiple_values</span> <span class="o">=</span> <span class="n">comparisons</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">fish_model</span><span class="p">,</span>
    <span class="n">idata</span><span class="o">=</span><span class="n">fish_idata</span><span class="p">,</span>
    <span class="n">contrast</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;persons&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
    <span class="n">conditional</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;child&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;livebait&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>
<span class="p">)</span>

<span class="n">multiple_values</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>term</th>
      <th>contrast</th>
      <th>child</th>
      <th>livebait</th>
      <th>camper</th>
      <th>estimate</th>
      <th>lower_3.0%</th>
      <th>upper_97.0%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>persons</td>
      <td>(1, 2)</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.527627</td>
      <td>0.295451</td>
      <td>0.775465</td>
    </tr>
    <tr>
      <th>1</th>
      <td>persons</td>
      <td>(1, 2)</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.883694</td>
      <td>2.605690</td>
      <td>3.177685</td>
    </tr>
    <tr>
      <th>2</th>
      <td>persons</td>
      <td>(1, 2)</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.131319</td>
      <td>0.067339</td>
      <td>0.195132</td>
    </tr>
    <tr>
      <th>3</th>
      <td>persons</td>
      <td>(1, 2)</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.717965</td>
      <td>0.592968</td>
      <td>0.857893</td>
    </tr>
    <tr>
      <th>4</th>
      <td>persons</td>
      <td>(1, 2)</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.032960</td>
      <td>0.015212</td>
      <td>0.052075</td>
    </tr>
    <tr>
      <th>5</th>
      <td>persons</td>
      <td>(1, 2)</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.180270</td>
      <td>0.123173</td>
      <td>0.244695</td>
    </tr>
    <tr>
      <th>6</th>
      <td>persons</td>
      <td>(1, 4)</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.834472</td>
      <td>2.563472</td>
      <td>7.037150</td>
    </tr>
    <tr>
      <th>7</th>
      <td>persons</td>
      <td>(1, 4)</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>26.423188</td>
      <td>23.739729</td>
      <td>29.072748</td>
    </tr>
    <tr>
      <th>8</th>
      <td>persons</td>
      <td>(1, 4)</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.202003</td>
      <td>0.631629</td>
      <td>1.780965</td>
    </tr>
    <tr>
      <th>9</th>
      <td>persons</td>
      <td>(1, 4)</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>6.571943</td>
      <td>5.469275</td>
      <td>7.642248</td>
    </tr>
    <tr>
      <th>10</th>
      <td>persons</td>
      <td>(1, 4)</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.301384</td>
      <td>0.143676</td>
      <td>0.467608</td>
    </tr>
    <tr>
      <th>11</th>
      <td>persons</td>
      <td>(1, 4)</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.648417</td>
      <td>1.140415</td>
      <td>2.187190</td>
    </tr>
    <tr>
      <th>12</th>
      <td>persons</td>
      <td>(2, 4)</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.306845</td>
      <td>2.267097</td>
      <td>6.280005</td>
    </tr>
    <tr>
      <th>13</th>
      <td>persons</td>
      <td>(2, 4)</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>23.539494</td>
      <td>20.990931</td>
      <td>26.240169</td>
    </tr>
    <tr>
      <th>14</th>
      <td>persons</td>
      <td>(2, 4)</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.070683</td>
      <td>0.565931</td>
      <td>1.585718</td>
    </tr>
    <tr>
      <th>15</th>
      <td>persons</td>
      <td>(2, 4)</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>5.853978</td>
      <td>4.858957</td>
      <td>6.848519</td>
    </tr>
    <tr>
      <th>16</th>
      <td>persons</td>
      <td>(2, 4)</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.268423</td>
      <td>0.124033</td>
      <td>0.412274</td>
    </tr>
    <tr>
      <th>17</th>
      <td>persons</td>
      <td>(2, 4)</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.468147</td>
      <td>1.024800</td>
      <td>1.960934</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Notice how the contrast <span class="math notranslate nohighlight">\(u\)</span> varies while the covariates <span class="math notranslate nohighlight">\(v\)</span> are held constant. Currently, however, plotting multiple contrast values can be difficult to interpret since the contrast is “abstracted” away onto the y-axis. Thus, it would be difficult to interpret which portion of the plot corresponds to which contrast value. Therefore, it is currently recommended that if you want to plot multiple contrast values, call <code class="docutils literal notranslate"><span class="pre">comparisons</span></code> directly to obtain the summary dataframe and plot the
results yourself.</p>
</section>
<section id="Default-contrast-and-conditional-values">
<h3>Default contrast and conditional values<a class="headerlink" href="#Default-contrast-and-conditional-values" title="Permalink to this heading">#</a></h3>
<p>Now, we move onto scenario 2 described above (grid of equally spaced and central values) in computing average predictive comparisons. You are not required to pass values for <code class="docutils literal notranslate"><span class="pre">contrast</span></code> and <code class="docutils literal notranslate"><span class="pre">conditional</span></code>. If you do not pass values, Bambi will compute default values for you. Below, it is described how these default values are computed.</p>
<p>The default value for <code class="docutils literal notranslate"><span class="pre">contrast</span></code> is a <em>centered difference</em> at the mean for a contrast variable with a numeric dtype, and <em>unique levels</em> for a contrast varaible with a categorical dtype. For example, if the modeler is interested in the comparison of a <span class="math notranslate nohighlight">\(5\)</span> unit increase in <span class="math notranslate nohighlight">\(u\)</span> where <span class="math notranslate nohighlight">\(u\)</span> is a numeric variable, Bambi computes the mean and then subtracts and adds <span class="math notranslate nohighlight">\(2.5\)</span> units to the mean to obtain a <em>centered difference</em>. By default, if no value is passed for the contrast
covariate, Bambi computes a one unit centered difference at the mean. For example, if only <code class="docutils literal notranslate"><span class="pre">contrast=&quot;persons&quot;</span></code> is passed, then <span class="math notranslate nohighlight">\(\pm\)</span> <span class="math notranslate nohighlight">\(0.5\)</span> is applied to the mean of persons. If <span class="math notranslate nohighlight">\(u\)</span> is a categorical variable, Bambi computes and returns the unique levels. For example, if <span class="math notranslate nohighlight">\(u\)</span> has levels [“high scool”, “vocational”, “university”], Bambi computes and returns the unique values of this variable.</p>
<p>The default values for <code class="docutils literal notranslate"><span class="pre">conditional</span></code> are more involved. Currently, by default, if a dict or list is passed to <code class="docutils literal notranslate"><span class="pre">conditional</span></code>, Bambi uses the ordering (keys if dict and elements if list) to determine which covariate to use as the main, group (color), and panel (facet) variable. This is the same logic used in <code class="docutils literal notranslate"><span class="pre">plot_comparisons</span></code> described above. Subsequently, the default values used for the <code class="docutils literal notranslate"><span class="pre">conditional</span></code> covariates depend on their ordering <strong>and</strong> dtype. Below, the psuedocode used for
computing default values covariates passed to <code class="docutils literal notranslate"><span class="pre">conditional</span></code> is outlined:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="s2">&quot;main&quot;</span><span class="p">:</span>

    <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="n">numeric</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">v</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">50</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">v</span> <span class="o">==</span> <span class="n">categorical</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

<span class="k">elif</span> <span class="n">v</span> <span class="o">==</span> <span class="s2">&quot;group&quot;</span><span class="p">:</span>

    <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="n">numeric</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">v</span> <span class="o">==</span> <span class="n">categorical</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

<span class="k">elif</span> <span class="n">v</span> <span class="o">==</span> <span class="s2">&quot;panel&quot;</span><span class="p">:</span>

    <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="n">numeric</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">v</span> <span class="o">==</span> <span class="n">categorical</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
<p>Thus, letting Bambi compute default values for <code class="docutils literal notranslate"><span class="pre">conditional</span></code> is equivalent to creating a hypothetical “data grid” of new values. Lets say we are interested in comparing the number of fish caught for the contrast <code class="docutils literal notranslate"><span class="pre">livebait</span></code> conditional on <code class="docutils literal notranslate"><span class="pre">persons</span></code> and <code class="docutils literal notranslate"><span class="pre">child</span></code>. This time, lets call <code class="docutils literal notranslate"><span class="pre">comparisons</span></code> first to gain an understanding of the data generating the plot.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">contrast_df</span> <span class="o">=</span> <span class="n">comparisons</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">fish_model</span><span class="p">,</span>
    <span class="n">idata</span><span class="o">=</span><span class="n">fish_idata</span><span class="p">,</span>
    <span class="n">contrast</span><span class="o">=</span><span class="s2">&quot;livebait&quot;</span><span class="p">,</span>
    <span class="n">conditional</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;persons&quot;</span><span class="p">,</span> <span class="s2">&quot;child&quot;</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">contrast_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>term</th>
      <th>contrast</th>
      <th>persons</th>
      <th>child</th>
      <th>camper</th>
      <th>estimate</th>
      <th>lower_3.0%</th>
      <th>upper_97.0%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>1.000000</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.694646</td>
      <td>1.252803</td>
      <td>2.081207</td>
    </tr>
    <tr>
      <th>1</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>1.000000</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.422448</td>
      <td>0.299052</td>
      <td>0.551766</td>
    </tr>
    <tr>
      <th>2</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>1.000000</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>0.026923</td>
      <td>0.012752</td>
      <td>0.043035</td>
    </tr>
    <tr>
      <th>3</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>1.061224</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.787412</td>
      <td>1.342979</td>
      <td>2.203158</td>
    </tr>
    <tr>
      <th>4</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>1.061224</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.445555</td>
      <td>0.317253</td>
      <td>0.580117</td>
    </tr>
    <tr>
      <th>5</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>1.061224</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>0.028393</td>
      <td>0.013452</td>
      <td>0.045276</td>
    </tr>
    <tr>
      <th>6</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>1.122449</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.885270</td>
      <td>1.422937</td>
      <td>2.313218</td>
    </tr>
    <tr>
      <th>7</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>1.122449</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.469929</td>
      <td>0.335373</td>
      <td>0.609249</td>
    </tr>
    <tr>
      <th>8</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>1.122449</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>0.029944</td>
      <td>0.014165</td>
      <td>0.047593</td>
    </tr>
    <tr>
      <th>9</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>1.183674</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.988500</td>
      <td>1.501650</td>
      <td>2.424762</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>As <code class="docutils literal notranslate"><span class="pre">livebait</span></code> was encoded as a categorical dtype, Bambi returned the unique levels of <span class="math notranslate nohighlight">\([0, 1]\)</span> for the contrast. <code class="docutils literal notranslate"><span class="pre">persons</span></code> and <code class="docutils literal notranslate"><span class="pre">child</span></code> were passed as the first and second element and thus act as the main and group variables, respectively. It can be see from the output above, that an equally spaced grid was used to compute the values for <code class="docutils literal notranslate"><span class="pre">persons</span></code>, whereas a quantile based grid was used for <code class="docutils literal notranslate"><span class="pre">child</span></code>. Furthermore, as <code class="docutils literal notranslate"><span class="pre">camper</span></code> was unspecified, the mode was used as the default
value. Lets go ahead and plot the commparisons.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_comparison</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">fish_model</span><span class="p">,</span>
    <span class="n">idata</span><span class="o">=</span><span class="n">fish_idata</span><span class="p">,</span>
    <span class="n">contrast</span><span class="o">=</span><span class="s2">&quot;livebait&quot;</span><span class="p">,</span>
    <span class="n">conditional</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;persons&quot;</span><span class="p">,</span> <span class="s2">&quot;child&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_plot_comparisons_19_0.png" src="../_images/notebooks_plot_comparisons_19_0.png" />
</div>
</div>
<p>The plot shows us that the expected differences in fish caught comparing a group of people who use livebait and no livebait is not only conditional on the number of persons, but also children. However, the plotted comparisons for <code class="docutils literal notranslate"><span class="pre">child</span></code> = <span class="math notranslate nohighlight">\(3\)</span> is difficult to interpret on a single plot. Thus, it can be useful to pass specific <code class="docutils literal notranslate"><span class="pre">group</span></code> and <code class="docutils literal notranslate"><span class="pre">panel</span></code> arguments to aid in the interpretation of the plot. Therefore, <code class="docutils literal notranslate"><span class="pre">subplot_kwargs</span></code> allows the user to manipulate the plotting by passing a
dictionary where the keys are <code class="docutils literal notranslate"><span class="pre">{&quot;main&quot;:</span> <span class="pre">...,</span> <span class="pre">&quot;group&quot;:</span> <span class="pre">...,</span> <span class="pre">&quot;panel&quot;:</span> <span class="pre">...}</span></code> and the values are the names of the covariates to be plotted. Below, we plot the same comparisons as above, but this time we specify <code class="docutils literal notranslate"><span class="pre">group</span></code> and <code class="docutils literal notranslate"><span class="pre">panel</span></code> to both be <code class="docutils literal notranslate"><span class="pre">child</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_comparison</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">fish_model</span><span class="p">,</span>
    <span class="n">idata</span><span class="o">=</span><span class="n">fish_idata</span><span class="p">,</span>
    <span class="n">contrast</span><span class="o">=</span><span class="s2">&quot;livebait&quot;</span><span class="p">,</span>
    <span class="n">conditional</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;persons&quot;</span><span class="p">,</span> <span class="s2">&quot;child&quot;</span><span class="p">],</span>
    <span class="n">subplot_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;main&quot;</span><span class="p">:</span> <span class="s2">&quot;persons&quot;</span><span class="p">,</span> <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="s2">&quot;child&quot;</span><span class="p">,</span> <span class="s2">&quot;panel&quot;</span><span class="p">:</span> <span class="s2">&quot;child&quot;</span><span class="p">},</span>
    <span class="n">fig_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s2">&quot;sharey&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
    <span class="n">legend</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_plot_comparisons_21_0.png" src="../_images/notebooks_plot_comparisons_21_0.png" />
</div>
</div>
</section>
<section id="Unit-level-contrasts">
<h3>Unit level contrasts<a class="headerlink" href="#Unit-level-contrasts" title="Permalink to this heading">#</a></h3>
<p>Evaluating average predictive comparisons at central values for the conditional covariates <span class="math notranslate nohighlight">\(v\)</span> can be problematic when the inputs have a large variance since no single central value (mean, median, etc.) is representative of the covariate. This is especially true when <span class="math notranslate nohighlight">\(v\)</span> exhibits bi or multimodality. Thus, it may be desireable to use the empirical distribution of <span class="math notranslate nohighlight">\(v\)</span> to compute the predictive comparisons, and then average over a specific or set of covariates to obtain the
average predictive comparisons. To achieve unit level contrasts, do not pass a parameter into <code class="docutils literal notranslate"><span class="pre">conditional</span></code> and or specify <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unit_level</span> <span class="o">=</span> <span class="n">comparisons</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">fish_model</span><span class="p">,</span>
    <span class="n">idata</span><span class="o">=</span><span class="n">fish_idata</span><span class="p">,</span>
    <span class="n">contrast</span><span class="o">=</span><span class="s2">&quot;livebait&quot;</span><span class="p">,</span>
    <span class="n">conditional</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># empirical distribution</span>
<span class="nb">print</span><span class="p">(</span><span class="n">unit_level</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">fish_model</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">unit_level</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>term</th>
      <th>contrast</th>
      <th>camper</th>
      <th>child</th>
      <th>persons</th>
      <th>estimate</th>
      <th>lower_3.0%</th>
      <th>upper_97.0%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.864408</td>
      <td>0.627063</td>
      <td>1.116105</td>
    </tr>
    <tr>
      <th>1</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.694646</td>
      <td>1.252803</td>
      <td>2.081207</td>
    </tr>
    <tr>
      <th>2</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.864408</td>
      <td>0.627063</td>
      <td>1.116105</td>
    </tr>
    <tr>
      <th>3</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>1.009094</td>
      <td>0.755449</td>
      <td>1.249551</td>
    </tr>
    <tr>
      <th>4</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.864408</td>
      <td>0.627063</td>
      <td>1.116105</td>
    </tr>
    <tr>
      <th>5</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>1.453235</td>
      <td>0.964674</td>
      <td>1.956434</td>
    </tr>
    <tr>
      <th>6</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>1.233247</td>
      <td>0.900295</td>
      <td>1.569891</td>
    </tr>
    <tr>
      <th>7</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>0.188019</td>
      <td>0.090328</td>
      <td>0.289560</td>
    </tr>
    <tr>
      <th>8</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>0.606361</td>
      <td>0.390571</td>
      <td>0.818549</td>
    </tr>
    <tr>
      <th>9</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.694646</td>
      <td>1.252803</td>
      <td>2.081207</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># empirical (observed) data used to fit the model</span>
<span class="n">fish_model</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>livebait</th>
      <th>camper</th>
      <th>persons</th>
      <th>child</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Above, <code class="docutils literal notranslate"><span class="pre">unit_level</span></code> is the comparisons summary dataframe and <code class="docutils literal notranslate"><span class="pre">fish_model.data</span></code> is the empirical data. Notice how the values for <span class="math notranslate nohighlight">\(v\)</span> are identical in both dataframes. However, for <span class="math notranslate nohighlight">\(u\)</span>, the values are different. However, these unit level contrasts are difficult to interpret as each row corresponds to <em>that</em> unit’s contrast. Therefore, it is useful to average over (marginalize) the estimates to summarize the unit level predictive comparisons.</p>
<section id="Marginalizing-over-covariates">
<h4>Marginalizing over covariates<a class="headerlink" href="#Marginalizing-over-covariates" title="Permalink to this heading">#</a></h4>
<p>Since the empirical distrubution is used for computing the average predictive comparisons, the same number of rows (250) is returned as the data used to fit the model. To average over a covariate, use the <code class="docutils literal notranslate"><span class="pre">average_by</span></code> argument. If <code class="docutils literal notranslate"><span class="pre">True</span></code> is passed, then <code class="docutils literal notranslate"><span class="pre">comparisons</span></code> averages over all covariates. Else, if a single or list of covariates are passed, then <code class="docutils literal notranslate"><span class="pre">comparisons</span></code> averages by the covariates passed.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># marginalize over all covariates</span>
<span class="n">comparisons</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">fish_model</span><span class="p">,</span>
    <span class="n">idata</span><span class="o">=</span><span class="n">fish_idata</span><span class="p">,</span>
    <span class="n">contrast</span><span class="o">=</span><span class="s2">&quot;livebait&quot;</span><span class="p">,</span>
    <span class="n">conditional</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">average_by</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>term</th>
      <th>contrast</th>
      <th>estimate</th>
      <th>lower_3.0%</th>
      <th>upper_97.0%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>3.649691</td>
      <td>2.956185</td>
      <td>4.333621</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Passing <code class="docutils literal notranslate"><span class="pre">True</span></code> to <code class="docutils literal notranslate"><span class="pre">average_by</span></code> averages over all covariates and is equivalent to taking the mean of the <code class="docutils literal notranslate"><span class="pre">estimate</span></code> and uncertainty columns. For example:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unit_level</span> <span class="o">=</span> <span class="n">comparisons</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">fish_model</span><span class="p">,</span>
    <span class="n">idata</span><span class="o">=</span><span class="n">fish_idata</span><span class="p">,</span>
    <span class="n">contrast</span><span class="o">=</span><span class="s2">&quot;livebait&quot;</span><span class="p">,</span>
    <span class="n">conditional</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">unit_level</span><span class="p">[[</span><span class="s2">&quot;estimate&quot;</span><span class="p">,</span> <span class="s2">&quot;lower_3.0%&quot;</span><span class="p">,</span> <span class="s2">&quot;upper_97.0%&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
estimate       3.649691
lower_3.0%     2.956185
upper_97.0%    4.333621
dtype: float64
</pre></div></div>
</div>
</section>
<section id="Average-by-subgroups">
<h4>Average by subgroups<a class="headerlink" href="#Average-by-subgroups" title="Permalink to this heading">#</a></h4>
<p>Averaging over all covariates may not be desired, and you would rather average by a group or specific covariate. To perform averaging by subgroups, users can pass a single or list of covariates to <code class="docutils literal notranslate"><span class="pre">average_by</span></code> to average over specific covariates. For example, if we wanted to average by <code class="docutils literal notranslate"><span class="pre">persons</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># average by number of persons</span>
<span class="n">comparisons</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">fish_model</span><span class="p">,</span>
    <span class="n">idata</span><span class="o">=</span><span class="n">fish_idata</span><span class="p">,</span>
    <span class="n">contrast</span><span class="o">=</span><span class="s2">&quot;livebait&quot;</span><span class="p">,</span>
    <span class="n">conditional</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">average_by</span><span class="o">=</span><span class="s2">&quot;persons&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>term</th>
      <th>contrast</th>
      <th>persons</th>
      <th>estimate</th>
      <th>lower_3.0%</th>
      <th>upper_97.0%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>1.0</td>
      <td>1.374203</td>
      <td>1.011290</td>
      <td>1.708711</td>
    </tr>
    <tr>
      <th>1</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>2.0</td>
      <td>1.963362</td>
      <td>1.543330</td>
      <td>2.376636</td>
    </tr>
    <tr>
      <th>2</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>3.0</td>
      <td>3.701510</td>
      <td>3.056586</td>
      <td>4.357385</td>
    </tr>
    <tr>
      <th>3</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>4.0</td>
      <td>7.358662</td>
      <td>6.047642</td>
      <td>8.655654</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># average by number of persons and camper by passing a list</span>
<span class="n">comparisons</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">fish_model</span><span class="p">,</span>
    <span class="n">idata</span><span class="o">=</span><span class="n">fish_idata</span><span class="p">,</span>
    <span class="n">contrast</span><span class="o">=</span><span class="s2">&quot;livebait&quot;</span><span class="p">,</span>
    <span class="n">conditional</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">average_by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;persons&quot;</span><span class="p">,</span> <span class="s2">&quot;camper&quot;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>term</th>
      <th>contrast</th>
      <th>persons</th>
      <th>camper</th>
      <th>estimate</th>
      <th>lower_3.0%</th>
      <th>upper_97.0%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.864408</td>
      <td>0.627063</td>
      <td>1.116105</td>
    </tr>
    <tr>
      <th>1</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.694646</td>
      <td>1.252803</td>
      <td>2.081207</td>
    </tr>
    <tr>
      <th>2</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>1.424598</td>
      <td>1.078389</td>
      <td>1.777154</td>
    </tr>
    <tr>
      <th>3</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>2.344439</td>
      <td>1.872191</td>
      <td>2.800661</td>
    </tr>
    <tr>
      <th>4</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>2.429459</td>
      <td>1.871578</td>
      <td>2.964242</td>
    </tr>
    <tr>
      <th>5</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>4.443540</td>
      <td>3.747840</td>
      <td>5.170052</td>
    </tr>
    <tr>
      <th>6</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>3.541921</td>
      <td>2.686445</td>
      <td>4.391176</td>
    </tr>
    <tr>
      <th>7</th>
      <td>livebait</td>
      <td>(0.0, 1.0)</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>10.739204</td>
      <td>9.024702</td>
      <td>12.432764</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>It is still possible to use <code class="docutils literal notranslate"><span class="pre">plot_comparisons</span></code> when passing an argument to <code class="docutils literal notranslate"><span class="pre">average_by</span></code>. In the plot below, the empirical distribution is used to compute unit level contrasts for <code class="docutils literal notranslate"><span class="pre">livebait</span></code> and then averaged over <code class="docutils literal notranslate"><span class="pre">persons</span></code> to obtain the average predictive comparisons. The plot below is similar to the second plot in this notebook. The differences being that: (1) a pairwise transition grid is defined for the second plot above, whereas the empirical distribution is used in the plot below,
and (2) in the plot below, we marginalized over the other covariates in the model (thus the reason for not having a <code class="docutils literal notranslate"><span class="pre">camper</span></code> or <code class="docutils literal notranslate"><span class="pre">child</span></code> group and panel, and a reduction in the uncertainty interval).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_comparison</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">fish_model</span><span class="p">,</span>
    <span class="n">idata</span><span class="o">=</span><span class="n">fish_idata</span><span class="p">,</span>
    <span class="n">contrast</span><span class="o">=</span><span class="s2">&quot;livebait&quot;</span><span class="p">,</span>
    <span class="n">conditional</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">average_by</span><span class="o">=</span><span class="s2">&quot;persons&quot;</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_plot_comparisons_35_0.png" src="../_images/notebooks_plot_comparisons_35_0.png" />
</div>
</div>
</section>
</section>
</section>
<section id="Logistic-Regression">
<h2>Logistic Regression<a class="headerlink" href="#Logistic-Regression" title="Permalink to this heading">#</a></h2>
<p>To showcase an additional functionality of <code class="docutils literal notranslate"><span class="pre">comparisons</span></code> and <code class="docutils literal notranslate"><span class="pre">plot_comparisons</span></code>, we fit a logistic regression model to the <a class="reference external" href="https://vincentarelbundock.github.io/Rdatasets/csv/Stat2Data/Titanic.csv">titanic dataset</a> with interaction terms to model the probability of survival. The titanic dataset gives the values of four categorical attributes for each of the 2201 people on board the Titanic when it struck an iceberg and sank. The attributes are social class (first class, second class,
third class, crewmember), age, sex (0 = female, 1 = male), and whether or not the person survived (0 = deceased, 1 = survived).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://vincentarelbundock.github.io/Rdatasets/csv/Stat2Data/Titanic.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">dat</span><span class="p">[</span><span class="s2">&quot;PClass&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dat</span><span class="p">[</span><span class="s2">&quot;PClass&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[st, nd, rd]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dat</span><span class="p">[</span><span class="s2">&quot;PClass&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dat</span><span class="p">[</span><span class="s2">&quot;PClass&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">dat</span><span class="p">[</span><span class="s2">&quot;PClass&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dat</span><span class="p">[</span><span class="s2">&quot;PClass&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">dat</span><span class="p">[</span><span class="s2">&quot;PClass&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="s2">&quot;PClass&quot;</span><span class="p">],</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dat</span><span class="p">[</span><span class="s2">&quot;SexCode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="s2">&quot;SexCode&quot;</span><span class="p">],</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">dat</span> <span class="o">=</span> <span class="n">dat</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;any&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic_model</span> <span class="o">=</span> <span class="n">bmb</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span>
    <span class="s2">&quot;Survived ~ PClass * SexCode * Age&quot;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">dat</span><span class="p">,</span>
    <span class="n">family</span><span class="o">=</span><span class="s2">&quot;bernoulli&quot;</span>
<span class="p">)</span>
<span class="n">titanic_idata</span> <span class="o">=</span> <span class="n">titanic_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">draws</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">target_accept</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Modeling the probability that Survived==1
Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [Intercept, PClass, SexCode, PClass:SexCode, Age, PClass:Age, SexCode:Age, PClass:SexCode:Age]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
  <progress value='8000' class='' max='8000' style='width:300px; height:20px; vertical-align: middle;'></progress>
  100.00% [8000/8000 00:15&lt;00:00 Sampling 4 chains, 0 divergences]
</div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 16 seconds.
</pre></div></div>
</div>
<section id="Comparison-types">
<h3>Comparison types<a class="headerlink" href="#Comparison-types" title="Permalink to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">comparisons</span></code> and <code class="docutils literal notranslate"><span class="pre">plot_comparisons</span></code> also allow you to specify the type of comparison to be computed. By default, a difference is used. However, it is also possible to take the ratio where comparisons would then become <em>average predictive ratios</em>. To achieve this, pass <code class="docutils literal notranslate"><span class="pre">&quot;ratio&quot;</span></code> into the argument <code class="docutils literal notranslate"><span class="pre">comparison_type</span></code>. Using different comparison types offers a way to produce alternative insights; especially when there are interaction terms as the value of one covariate depends on the value
of the other covariate.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_comparison</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">titanic_model</span><span class="p">,</span>
    <span class="n">idata</span><span class="o">=</span><span class="n">titanic_idata</span><span class="p">,</span>
    <span class="n">contrast</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;PClass&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]},</span>
    <span class="n">conditional</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span> <span class="s2">&quot;SexCode&quot;</span><span class="p">],</span>
    <span class="n">comparison_type</span><span class="o">=</span><span class="s2">&quot;ratio&quot;</span><span class="p">,</span>
    <span class="n">subplot_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;main&quot;</span><span class="p">:</span> <span class="s2">&quot;Age&quot;</span><span class="p">,</span> <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="s2">&quot;SexCode&quot;</span><span class="p">,</span> <span class="s2">&quot;panel&quot;</span><span class="p">:</span> <span class="s2">&quot;SexCode&quot;</span><span class="p">},</span>
    <span class="n">fig_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s2">&quot;sharey&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
    <span class="n">legend</span><span class="o">=</span><span class="kc">False</span>

<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_plot_comparisons_40_0.png" src="../_images/notebooks_plot_comparisons_40_0.png" />
</div>
</div>
<p>The left panel shows that the ratio of the probability of survival comparing <code class="docutils literal notranslate"><span class="pre">PClass</span></code> <span class="math notranslate nohighlight">\(3\)</span> to <span class="math notranslate nohighlight">\(1\)</span> conditional on <code class="docutils literal notranslate"><span class="pre">Age</span></code> is non-constant. Whereas the right panel shows an approximately constant ratio in the probability of survival comparing <code class="docutils literal notranslate"><span class="pre">PClass</span></code> <span class="math notranslate nohighlight">\(3\)</span> to <span class="math notranslate nohighlight">\(1\)</span> conditional on <code class="docutils literal notranslate"><span class="pre">Age</span></code>.</p>
</section>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="plot_cap.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Plot Conditional Adjusted Predictions</p>
      </div>
    </a>
    <a class="right-next"
       href="../api_reference.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">API Reference</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Average-Predictive-Differences">Average Predictive Differences</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Computing-Average-Predictive-Differences">Computing Average Predictive Differences</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Zero-Inflated-Poisson">Zero Inflated Poisson</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#User-Provided-Values">User Provided Values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Multiple-contrast-values">Multiple contrast values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Default-contrast-and-conditional-values">Default contrast and conditional values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Unit-level-contrasts">Unit level contrasts</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Marginalizing-over-covariates">Marginalizing over covariates</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Average-by-subgroups">Average by subgroups</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Logistic-Regression">Logistic Regression</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Comparison-types">Comparison types</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="../_sources/notebooks/plot_comparisons.ipynb.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2022, The developers of Bambi.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.1.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>